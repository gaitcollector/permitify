
<div class="container">
    <h1>Dashboard</h1>

    <div class="container">
      <h2>My Bookings</h2>
        <div class="row">
          <% @bookings.each do |booking| %>
            <div class="col-12 col-lg-4">
              <div class="card bg-light">
                  <% if booking.permit.photo.attached? %>
                    <%= cl_image_tag booking.permit.photo.key, height: 300, width: 400, crop: :fill %>
                  <% else %>
                    <img class = "default-img-full" src="https://image.shutterstock.com/image-vector/picture-vector-icon-no-image-260nw-1350441335.jpg", height: 300, width: 300, crop: :fill>
                  <% end  %>

                <div class="card-body">
                  <table>
                    <tbody>
                      <tr><th>Permit:</th> <td><%= booking.permit.name %></td></tr>
                      <tr><th>Description:</th> <td> <%= booking.permit.description %></td></tr>
                      <tr><th>Total Price:</th> <td> $<%= booking.total_price %></td></tr>
                      <tr><th>Start Date:</th> <td> <%= booking.start_date %></td></tr>
                      <tr><th>End Date:</th> <td> <%= booking.end_date %></td></tr>
                      <tr><th>Booking Status:</th> <td> <%= booking.status %></td></tr>
                      </tbody>
                    </table>
                    <%= link_to 'Show', booking %> |
                    <% if booking.user == current_user %>
                      <%= link_to 'Edit', edit_booking_path(booking) %>
                    <% end %> |
                    <% if booking.user == current_user %>
                      <%= link_to 'Destroy', booking, method: :delete, data: { confirm: 'Are you sure?' } %>
                    <% end %>
                </div>
              </div>
            </div>
          <% end %>
        </div>
    </div>

    <div class="container">
      <h2>My Requests</h2>
        <div class="row">
          <% @requests.each do |booking| %>
            <div class="col-12 col-lg-4">
              <div class="card bg-light">
                <% if booking.permit.photo.attached? %>
                  <%= cl_image_tag booking.permit.photo.key, height: 300, width: 400, crop: :fill %>
                <% else %>
                  <img class = "default-img-full" src="https://image.shutterstock.com/image-vector/picture-vector-icon-no-image-260nw-1350441335.jpg", height: 300, width: 300, crop: :fill>
                <% end  %>

                <div class="card-body">
                  <table>
                    <tbody>
                        <tr><th>Permit:</th> <td><%= booking.permit.name %></td></tr>
                        <tr><th>Description:</th> <td> <%= booking.permit.description %></td></tr>
                        <tr><th>Total Price:</th> <td> $<%= booking.total_price %></td></tr>
                        <tr><th>Start Date:</th> <td> <%= booking.start_date %></td></tr>
                        <tr><th>End Date:</th> <td> <%= booking.end_date %></td></tr>
                        <tr><th>Booking Status:</th> <td> <%= booking.status %></td></tr>
                      </body>
                  </table>

                  <%= link_to 'Accept', booking_path(booking, booking: {status: "Booked"}), method: :patch, data: { confirm: 'Are you sure?' } %> |
                  <% if booking.status != "Declined"%>
                    <%= link_to 'Decline', booking_path(booking, booking: {status: "Declined"}), method: :patch, data: { confirm: 'Are you sure?' } %>
                  <% end %>
                </div>
              </div>
            </div>
          <% end %>


        </div>
      </div>
    <% end %>
  </div>
</div>
